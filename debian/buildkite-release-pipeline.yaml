steps:
  - label: "Debian 10 (i386)"
    commands:
      - >-
        gbp buildpackage
          --git-ignore-branch
          --git-upstream-tree=${BUILDKITE_COMMIT}
          --git-builder="sbuild --dist=buster --arch=i386 --no-clean-source -j${X_PARALLEL_JOBS}"
          --git-export-dir=debian/build/buster/i386/

      - '(cd debian/build/ && buildkite-agent artifact upload "*")'

    agents:
      queue: "linux-debian"

  - label: "Debian 10 (amd64)"
    commands:
      - >-
        gbp buildpackage
          --git-ignore-branch
          --git-upstream-tree=${BUILDKITE_COMMIT}
          --git-builder="sbuild --dist=buster --arch=amd64 --no-clean-source -j${X_PARALLEL_JOBS}"
          --git-export-dir=debian/build/buster/amd64/

      - '(cd debian/build/ && buildkite-agent artifact upload "*")'

    agents:
      queue: "linux-debian"
