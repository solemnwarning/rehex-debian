steps:
  - label: "Debian 11 (i386)"
    commands:
      - >-
        gbp buildpackage
          --git-ignore-branch
          --git-upstream-tree=${BUILDKITE_COMMIT}
          --git-builder="sbuild --dist=bullseye --arch=i386 --no-clean-source -j${X_PARALLEL_JOBS}"
          --git-export-dir=debian/build/bullseye/i386/

      - '(cd debian/build/ && buildkite-agent artifact upload "*")'

    agents:
      queue: "linux-debian"

  - label: "Debian 11 (amd64)"
    commands:
      - >-
        gbp buildpackage
          --git-ignore-branch
          --git-upstream-tree=${BUILDKITE_COMMIT}
          --git-builder="sbuild --dist=bullseye --arch=amd64 --no-clean-source -j${X_PARALLEL_JOBS}"
          --git-export-dir=debian/build/bullseye/amd64/

      - '(cd debian/build/ && buildkite-agent artifact upload "*")'

    agents:
      queue: "linux-debian"
